"0","#| echo: False"
"0",""
"0","set.seed(999)"
"0","avesFCFL <- data |> filter(Sec_Ref != ""Brinkworth_et_al_2023"") |> filter( Aves == ""Y"" & !is.na(FemurCirc) & !is.na(FemurLen))"
"0",""
"0","# Training and testing sets"
"0",""
"0",""
"0","sample.test <-c(sample(x = 1:nrow(avesFCFL),size = ceiling(nrow(avesFCFL)* 0.3)),which(avesFCFL$Clade.2 ==""Sphenisciformes""))"
"0",""
"0","avesFCFL.test <- avesFCFL[sample.test,]"
"0","avesFCFL.train <- avesFCFL[-sample(x = 1:nrow(avesFCFL),size = ceiling(nrow(avesFCFL)* 0.2)),]"
"0",""
"0","# Fit lineal model"
"0","lm_FC <- lm(FemurCirc ~ FemurLen, data = avesFCFL.train)"
"0",""
"0","# Fit loglog model"
"0","loglog_FC <- lm(log(FemurCirc) ~ log(FemurLen), data = avesFCFL.train)"
"0",""
"0","# Multiple linear regression Clade 1"
"0","lmClade1_FC <- lm(FemurCirc ~ FemurLen + Clade.1, data = avesFCFL.train)"
"0",""
"0",""
"0","# Multiple loglog linear regression Clade 1"
"0","logClade1_FC <- lm(log(FemurCirc) ~ log(FemurLen) + Clade.1, data = avesFCFL.train)"
"0",""
"0",""
"0","# Multiple linear regression Clade 2"
"0","lmClade2_FC <- lm(FemurCirc ~ FemurLen + Clade.2, data = avesFCFL.train)"
"0",""
"0","# Multiple loglog linear regression Clade 2"
"0","logClade2_FC <- lm(log(FemurCirc) ~ log(FemurLen) + Clade.2, data = avesFCFL.train)"
"0",""
"0","# Poly model "
"0","poly2_FC <- lm(FemurCirc ~ poly(FemurLen,2), data = avesFCFL.train)"
"0",""
"0",""
"0","# Multiple Poly model Clade 1"
"0","poly2Clade1_FC <- lm(FemurCirc ~ poly(FemurLen,2) + Clade.1 , data = avesFCFL.train)"
"0",""
"0","# Multiple Poly model Clade 2"
"0","poly2Clade2_FC <- lm(FemurCirc ~ poly(FemurLen,2) + Clade.2, data = avesFCFL.train)"
"0",""
"0","fitvals_FC.train <- data.frame(FemurLen = avesFCFL.train$FemurLen, "
"0","                         trueFC = avesFCFL.train$FemurCirc,"
"0","                         lm_FC = lm_FC$fitted.values, "
"0","                         loglog_FC = exp(loglog_FC$fitted.values),"
"0","                         lmClade1_FC = lmClade1_FC$fitted.values,"
"0","                         logClade1_FC = exp(logClade1_FC$fitted.values),"
"0","                         lmClade2_FC = lmClade2_FC$fitted.values,"
"0","                         logClade2_FC = exp(logClade2_FC$fitted.values),"
"0","                         poly2_FC = poly2_FC$fitted.values,"
"0","                         poly2Clade1_FC = poly2Clade1_FC$fitted.values,"
"0","                         poly2Clade2_FC = poly2Clade2_FC$fitted.values)"
"0",""
"0",""
"0","fitvals_FC.long <- fitvals_FC.train %>% pivot_longer(-FemurLen, names_to = 'model', values_to = 'FemurCirc')"
"0",""
"0",""
"0",""
"0",""
